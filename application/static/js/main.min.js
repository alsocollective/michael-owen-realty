var app={options:{loadingpage:!1,pagetransitiontime:1e3,previousURL:null},init:function(){$("nav a").click(app.nav.navmenueclick),app.url.init(),$("#navbutton").click(app.nav.togglemenue),app.url.setupPagescroll(".mainwrapper"),app.resize(),$(window).resize(app.resize),$(window).on("popstate",app.url.changepage)},nav:{navmenueclick:function(a){if(!this.href||!a.preventDefault)return!1;var b=this.href,c=b.split(":")[0];return"mailto"!=c&&"tel"!=c?app.options.loadingpage?(a.preventDefault(),!1):(app.nav.loadpage(this.href),$("#navbutton").hasClass("navactive")&&app.nav.togglemenue(),!1):void 0},loadpage:function(a,b){if(app.options.loadingpage=!0,b){var c=a.split("/"),d=c[c.length-1],c="/"+d;app.nav.changeurl(c)}else app.url.seturlfromfull(a);a=app.url.addajax(a);var e=document.createElement("div");e.className="mainwrapper offright",document.body.appendChild(e),$(e).load(a,function(){$.waypoints("destroy");var a=$(".mainwrapper"),b=$(a[0]),c=$(a[1]);b.addClass("offleft"),c.removeClass("offright"),app.nav.deleteEl(b[0],app.options.pagetransitiontime),app.url.gotohashlocation(),app.options.previousURL=document.URL.split("#")[0]})},deleteEl:function(a,b){setTimeout(function(){app.options.loadingpage=!1,a.parentNode.removeChild(a),app.url.setupPagescroll(".mainwrapper")},b)},togglemenue:function(){$("nav").toggleClass("offleft"),$("#navbutton").toggleClass("navactive")},changeurl:function(a){$(".currentpage").removeClass("currentpage"),$($('a[href="'+a+'"]')[0].parentNode).addClass("currentpage")},correctSize:function(){$("#nav").width($($(".mainwrapper div")[0]).width())}},url:{init:function(){app.options.previousURL=document.URL.split("#")[0],app.url.gotohashlocation()},seturlfromfull:function(a){var a=a.split("/"),b=a[a.length-1],a="/"+b;return window.history.pushState({id:b,path:a},b,a),app.nav.changeurl(a),!1},addajax:function(a){var b=a.split("/");""==b[b.length-1]&&b.length<5&&(b[b.length-1]="home");var c="ajax";return b.length<5?b[b.length-1]=c+b[b.length-1]:(b[b.length-2]=c+b[b.length-2],b[b.length-1]=""),b.join("/")},setupPagescroll:function(a){var b=$(a+" h2");b.waypoint(app.url.setSectionAsHash,{context:".mainwrapper"})},setSectionAsHash:function(){console.log("new subsection")},slugify:function(a){return a.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,"")},gotohashlocation:function(){$(location.hash)},changepage:function(){app.nav.loadpage(document.URL,!0)}},about:{init:function(){$(".reference").slick({dots:!0,arrows:!1}),app.property.setup()}},search:{init:function(){app.search.setuppriceSlider(),app.search.setupBedSlider(),app.search.setupBathSlider(),app.property.setup(),app.search.neighbourhoodSetup()},setuppriceSlider:function(){var a=$(".offright #priceslider");0==a.length&&(a=$("#priceslider")),a.noUiSlider({start:[0,4e5],connect:!0,behaviour:"drag",range:{min:[0],max:[15e5]},format:wNumb({mark:".",decimals:0,thousand:",",prefix:"$ "}),step:1e4}),a.Link("lower").to($("#lowerprice")),a.Link("upper").to($("#upperprice"))},setupBedSlider:function(){var a=$(".offright #bedslider");0==a.length&&(a=$("#bedslider")),a.noUiSlider({start:[1,3],connect:!0,behaviour:"drag",range:{min:[1],max:[10]},format:wNumb({mark:".",decimals:0}),step:1}),a.Link("lower").to($("#lowerbed")),a.Link("upper").to($("#upperbed"))},setupBathSlider:function(){var a=$(".offright #bathslider");0==a.length&&(a=$("#bathslider")),a.noUiSlider({start:[1,3],connect:!0,behaviour:"drag",range:{min:[1],max:[10]},format:wNumb({mark:".",decimals:1}),step:.5}),a.Link("lower").to($("#lowerbath")),a.Link("upper").to($("#upperbath"))},neighbourhoodSetup:function(){$("#neighbourhoods a").click(app.search.neighbourhoodClick)},neighbourhoodClick:function(a){return $("#neighbourhoodajax").load(this.href),a.preventDefault(),!1}},sell:{init:function(){console.log("sell setting up")}},property:{init:function(){$(".propertyimages").slick({dots:!0,arrows:!1}),$(".module").click(app.property.delete),$(".module > div > div").click(app.property.stopprop)},"delete":function(){this.parentNode.removeChild(this)},setup:function(){$(".propertylist li").click(app.property.loadproperty)},loadproperty:function(){if(app.options.loadingpage)return!1;var a=document.createElement("div");a.className="module",document.body.appendChild(a),$(a).load("/ajaxproperty",app.property.loadedproperty)},stopprop:function(a){a.stopPropagation()},loadedproperty:function(){app.property.init()}},resize:function(){app.nav.correctSize()}};